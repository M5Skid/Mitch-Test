name: Create Release and File

on:
  workflow_dispatch:
    inputs: 
      version:
        description: 'version number'
        required: true
        default: 0.3.25
        
jobs:
  Create_release:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: process1
    steps:
    - name: Check out code
      uses: actions/checkout@v2
      with:
        ref: main
    - name: Check for version.cfg
      run: |
        if [ -e version.cfg ]; then
          current_version="${cat version.cfg | cut -c 20-26}"
          sed -i 's/${current_version}/${{ github.event.inputs.version }}/g' version.cfg
        else  
          echo 'Current Version "${{ github.event.inputs.version }}"' >> version.cfg
        fi  
    - name: Pull request
      uses: peter-evans/create-pull-request@v3
      with:
        branch: release/${{ github.event.inputs.version }}
        commit-message: 'chore: release ${{ github.event.inputs.version }}'
        base: main
        labels: chore
        reviewers: M5Skid
        assignees: M5Skid
        body: |
          Releasing ${{ github.event.inputs.version }}.
